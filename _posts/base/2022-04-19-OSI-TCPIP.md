---
layout: post
title: 七层网络协议
Subtitle: 如何让网络有序的？（为了快递不丢都做了什么）
---



根据货物先要选择一家物流，选择完填单约物流上门（这个时候物流公司只关心填单对不对，填单不对是约不上的）。
物流公司根据要求对货物进行分组打包，如果太多里就按分组顺序多打几个包，确认一下分组包含里所有货物没有遗漏。
包上都贴好地址。放到物流货箱里发出。

## OSI参考模型，TCP/IP实际模型

OSI Open System Interconnection Reference Model 开放式系统互联通信参考模型，是个七层模型。

| 位置 | OSI | 功能 | 协议 |
| :----- | :----- | :------: | :-------: |
| 网络 | Physical Layer 物理层（比特） | 建立物理连接（MAC），翻译成机器能识别的底层语言 | 0/1信号 并不寻址 |
| 网络 | Data Link Layer 数据链路层（帧） | 建立逻辑连接，定义如何格式化数据，差错校验 | 以太网、PPP |
| 网络 | Network Layer 网络层（数据包） | 逻辑地址寻址 | IP 给包贴上地址，联网设备的唯一性 |
| 主机 | Transport Layer 传输层（数据段） | 建立端口对端口的连接 | TCP UDP TLS/SSL 确保收到或发出所有包 |
| 主机 | Session Layer 会话层 | 建立管理和终止，应用程序间的会话 | SQL windows 打包，与不同的人建立回话 |
| 主机 | Presentation Layer 表示层 | 格式化数据，只关心信息发出的语法和语义 | ASCII SSL 数据的表示、压缩、解压、加密、解密都在该层完成，应用程序和网络之间的翻译官 |
| 主机 | Application Layer 应用层 | 应用软件间通信的协议，控制应用程序 | HTTP FTP DNS SSH TELNET 标准最多，相对其他层最不成熟 |

底层协议支持上层协议，比如以太网协议、PPP协议。PPP协议在同一个广播域中只能有两个节点，比如电脑联网，只能有一个对外的广域ip地址，这个地址是宽带代理商分配的，用户无法自行改变。
而以太网则可以在同一广播域里加入多个节点，比如智能家居情境中，一个家庭局域网中，可以给多个联网设备分配ip联网，用户可以根据需求重设各设备ip。

这些协议，是在互联网还没出现前就有了，七层模型很精致，可惜没有流行起来，所以OSI现在只是个参考模型，实际上现在流行的是TCP/IP模型。

TCP/IP Transmission Control Protocol / Internet Protocol 传输控制协议/网际协议模型，是四层模型。
很多协议在OSI模型中哪层位置不是确定的，因为OSI是只个参考模型，不是实际模型，TCP/IP模型（或者说TCP/IP协议族）是应用最广泛的网络解决方案。

| 位置 | TCP/IP | 协议族 | 传递信息 |
| :----- | :----- | :------: | :-------: |
| 用户 | 应用层 | ping telnet OSPF DNS | 报文（message） |
| 内核 | 传输层 | TCP UDP | 报文段（segment） |
| 内核 | 网络层 | ICMP IP | 分组（packet） |
| 内核 | 数据链路层 | ARP DataLink RARP | 帧（frame）、PDU（bit） |

TCP/IP协议族是基于TCP和IP这两个最初的协议之上的不同的通信协议的大集合。

抓包，抓到的是传输层的包，packet/frame/Datagram/segment是存在于同条记录中的，这些是基于所在协议层的不同取了不同的名字。

数据包格式：
| Head | Head | Head | Data |
| :--- | :--- | :--- | :---: |
| 以太网 | IP | TCP | 应用层 |
| 标头 | 标头 | 标头 | 数据包 |